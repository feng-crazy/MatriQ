#### 一、项目背景
在电子制造企业中，电子元器件通常以盘卷形式存储和运输，其外包装上贴有包含关键信息的标签（如物料编码、数量、批次、生产日期、品牌、电气特性等）。传统人工录入方式效率低、易出错。为提升自动化水平、减少人为干预、实现数据可追溯，需开发一套智能识别系统，自动从图像中提取标签信息，并支持与企业信息系统对接。

---

## 二、核心目标
开发一套名为 **MatriQ** 的物料标签识别助手系统，实现以下目标：

1. **自动识别** 流水线上电子元器件盘卷标签中的关键字段；
2. **结构化输出** 包括但不限于：
    - 物料编码（Material Code）
    - 数量（Quantity）
    - 批次号（Batch/Lot Number）
    - 日期（Date / Production Date）
    - 品牌（Brand，如 “Sunlord”）
    - 电气特性（Electrical Characteristics，如电感值、容差等）
3. **支持多语言/格式兼容**：字段名称可能为中文、英文或缩写，位置不固定；
4. **数据持久化**：将识别结果按流水线分类存入 Excel 表格；
5. **系统扩展性**：预留标准接口，便于未来对接企业 ERP/MES 等系统。

---

## 三、功能模块说明
### 3.1 流水线管理
+ **前端功能**：
    - 支持用户创建新的“识别流水线”（每条流水线对应一个独立业务场景或产线）；
    - 展示已有流水线列表（名称、创建时间、累计识别次数等）；
    - 可点击进入某条流水线进行操作。
+ **后端逻辑**：
    - 每新建一条流水线，系统自动创建一个专属的 Excel 文件（如 `Line_001_MatriQ.xlsx`）用于存储该流水线的所有识别记录；
    - Excel 文件路径与流水线 ID 绑定，确保数据隔离。

### 3.2 图像上传与采集
+ **支持方式**：
    - 本地图片上传（JPG/PNG 等常见格式）；
    - 调用设备摄像头实时拍照（Web 前端通过浏览器 API，小程序端调用微信相机）；
+ **使用流程**：
    - 用户选择/进入某条流水线；
    - 在该流水线页面内执行上传或拍照；
    - 图片提交至后端 API 进行处理。

### 3.3 物体检测与文字识别（OCR）
+ **处理流程**：
    1. **物体预判**：后端首先使用轻量级图像分类模型判断上传图片是否为“电子元器件盘卷”（防止误识别非目标物体）；
    2. **文字识别**：若确认为目标物体，则调用 OCR 引擎（推荐使用 **PaddleOCR**）提取图像中全部文字内容；
    3. **后处理解析**：
        * 基于规则引擎 + 关键词匹配 + 正则表达式，从 OCR 结果中提取目标字段；
        * 支持字段别名映射（例如：“Qty”、“数量”、“QUANTITY” → 统一为 “数量”）；
        * 对“日期”进行标准化（如 “2025/11/30”、“30-Nov-2025” → “2025-11-30”）；
        * 对“电气特性”做模糊匹配（如 “L=10uH±10%” 提取为 “10uH ±10%”）；
        * 若无法识别某字段，标记为“未识别”，但保留原始 OCR 文本供人工复核。
+ **输出格式**（JSON 示例）：

```json
{
  "material_code": "SL-IND-1008-100",
  "quantity": 4000,
  "batch": "B2511A",
  "date": "2025-11-30",
  "brand": "Sunlord",
  "electrical_characteristics": "10uH ±10%",
  "raw_ocr_text": "Sunlord SL-IND-1008-100 Qty:4000 Batch:B2511A Date:30/11/2025 L=10uH±10%"
}
```

### 3.4 数据存储与导出
+ 每次成功识别后，将结构化结果追加写入对应流水线的 Excel 文件；
+ Excel 表头固定为：  
| 序号 | 识别时间 | 物料编码 | 数量 | 批次 | 日期 | 品牌 | 电气特性 | 原始OCR文本 | 图片文件名 |
+ 支持前端下载该流水线的完整 Excel 文件；
+ 后端定期备份或提供 API 导出接口。

### 3.5 系统集成预留
+ 提供 RESTful API 接口（如 `/api/v1/scan-result`），支持将识别结果以 JSON 格式推送至外部系统；
+ 接口支持认证（如 API Key 或 Token）；
+ 未来可扩展 Webhook、MQTT 或直接对接 SAP/Oracle/用友等 ERP 系统。

---

## 四、技术架构
| 层级 | 技术选型建议 |
| --- | --- |
| **前端** | - Web 端：Vue.js / React + Element UI / Ant Design   - 小程序端：微信小程序（Taro 或原生） |
| **后端 API** | Go（高性能）或 Python（快速开发，生态丰富）   框架：Gin（Go） / FastAPI（Python） |
| **OCR 引擎** | PaddleOCR（支持多语言、高精度、可部署） |
| **物体检测** | 可选 YOLOv5s / MobileNet + 自定义训练（仅需区分“盘卷” vs “非盘卷”） |
| **数据存储** | Excel 文件（初期）+ 可选 SQLite / PostgreSQL（后期扩展） |
| **部署** | Docker 容器化，支持本地服务器或云部署 |


---

## 五、非功能性需求
+ **响应时间**：单张图片从上传到返回结构化结果 ≤ 3 秒（局域网环境）；
+ **准确率**：关键字段（如物料编码、批次）识别准确率 ≥ 95%（在清晰图像前提下）；
+ **兼容性**：支持主流浏览器（Chrome, Edge, Safari）及微信小程序；
+ **安全性**：图片上传需做格式校验与病毒扫描；API 需防重放与注入攻击；
+ **可维护性**：后处理规则应配置化（如 YAML/JSON 规则文件），便于调整字段映射逻辑。

---

## 六、交付物
1. Web 前端系统（含流水线管理、上传、结果展示）；
2. 微信小程序端（核心功能同步 Web）；
3. 后端 API 服务（含 OCR 调用、规则引擎、Excel 写入）；
4. 预训练的物体分类模型（盘卷识别）；
5. 系统部署文档与 API 接口文档；
6. 测试用例与验收标准。

---

## 七、后续扩展方向
+ 支持批量上传与批量识别；
+ 增加人工复核界面，对“未识别”字段进行修正并反馈训练数据；
+ 引入大模型（如 Qwen-VL）辅助复杂标签理解；
+ 与 MES 系统联动，自动触发入库流程。

---

**备注**：本需求文档为初版，可根据实际业务场景进一步细化字段规则、UI 设计及性能指标。

---

#### 附录
![](https://cdn.nlark.com/yuque/0/2025/jpeg/22096469/1764412384262-1847c2c3-061e-443f-a821-30d087141503.jpeg)![](https://cdn.nlark.com/yuque/0/2025/jpeg/22096469/1764412337712-31a3d13d-4bb4-465d-aa29-0e07f0009977.jpeg)

